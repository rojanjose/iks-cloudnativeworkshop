
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Javier Torres">
      
      
        <link rel="canonical" href="https://jrtorres.github.io/iks-cloudnativeworkshop/generatedContent/istio101/exercise-6/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Lab 4. Traffic Management - IKS Cloud Native Workshop</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700%7CIBM+Plex+Mono&display=fallback">
        <style>:root{--md-text-font-family:"IBM Plex Sans";--md-code-font-family:"IBM Plex Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercise-4-perform-traffic-management" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="IKS Cloud Native Workshop" class="md-header__button md-logo" aria-label="IKS Cloud Native Workshop" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IKS Cloud Native Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 4. Traffic Management
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://jrtorres.github.io/iks-cloudnativeworkshop/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    iks-cloudnativeworkshop
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Welcome
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../workshop-setup/docs/GRANTCLUSTER/" class="md-tabs__link">
        Environment Setup
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../kube101/Lab1/" class="md-tabs__link">
        Kube 101
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../helm101/Lab1/" class="md-tabs__link">
        Helm 101
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../jenkins101/" class="md-tabs__link">
        Jenkins 101
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../deploy-microservices/README_deployment/" class="md-tabs__link">
        Microservices
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../kubernetes-storage/" class="md-tabs__link">
        Storage
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../kubernetes-operators/" class="md-tabs__link">
        Operators
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../exercise-1/" class="md-tabs__link md-tabs__link--active">
        Istio 101
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="IKS Cloud Native Workshop" class="md-nav__button md-logo" aria-label="IKS Cloud Native Workshop" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    IKS Cloud Native Workshop
  </label>
  
    <div class="md-nav__source">
      
<a href="https://jrtorres.github.io/iks-cloudnativeworkshop/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    iks-cloudnativeworkshop
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Welcome
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Welcome" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Welcome
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Workshop Overview
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Environment Setup
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Environment Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Environment Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../workshop-setup/docs/GRANTCLUSTER/" class="md-nav__link">
        Grant Kubernetes Cluster
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../pre-work/" class="md-nav__link">
        Cloud Shell
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Kube 101
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Kube 101" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Kube 101
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kube101/Lab1/" class="md-nav__link">
        Lab 1. Deploy your first application
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kube101/Lab2/" class="md-nav__link">
        Lab 2. Scale and update deployments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kube101/Lab3/" class="md-nav__link">
        Lab 3. Build multi-tier applications
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Helm 101
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Helm 101" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Helm 101
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../helm101/Lab1/" class="md-nav__link">
        Lab 1. Deploy with Helm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../helm101/Lab2/" class="md-nav__link">
        Lab 2. Make changes with Helm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../helm101/Lab3/" class="md-nav__link">
        Lab 3. Keeping track of the deployed application
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../helm101/Lab4/" class="md-nav__link">
        Lab 4. Share Helm Charts
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Jenkins 101
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Jenkins 101" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Jenkins 101
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../jenkins101/" class="md-nav__link">
        Jenkins and Kubernetes
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Microservices
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Microservices" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Microservices
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy-microservices/README_deployment/" class="md-nav__link">
        Lab 1. Deploy Microservices Application
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Storage
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Storage" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-storage/" class="md-nav__link">
        Kubernetes Storage
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-storage/Lab0/" class="md-nav__link">
        Lab 0. Prework
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-storage/Lab1/" class="md-nav__link">
        Lab 1. Container storage and Kubernetes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-storage/Lab2/" class="md-nav__link">
        Lab 2. File storage with kubernetes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-storage/Lab3/" class="md-nav__link">
        Lab 3. Block storage with kubernetes
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Operators
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Operators" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Operators
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-operators/" class="md-nav__link">
        Kubernetes Operators
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-operators/setup/" class="md-nav__link">
        Lab 0. Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-operators/lab1/" class="md-nav__link">
        Lab 1. Custom Resource (CR)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-operators/lab2/" class="md-nav__link">
        Lab 2. Go Operator with Operator SDK
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes-operators/lab3/" class="md-nav__link">
        Lab 3. Operator from Helm
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      <label class="md-nav__link" for="__nav_9">
        Istio 101
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Istio 101" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Istio 101
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise-1/" class="md-nav__link">
        Lab 1. Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise-2/" class="md-nav__link">
        Lab 2. Install Istio
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise-3/" class="md-nav__link">
        Lab 3. Deploy Guestbook App
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Lab 4. Traffic Management
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Lab 4. Traffic Management
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-rules-to-manage-traffic" class="md-nav__link">
    Using rules to manage traffic
  </a>
  
    <nav class="md-nav" aria-label="Using rules to manage traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#virtual-services" class="md-nav__link">
    Virtual Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destination-rules" class="md-nav__link">
    Destination Rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-entries" class="md-nav__link">
    Service Entries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-guestbook-app" class="md-nav__link">
    The Guestbook app
  </a>
  
    <nav class="md-nav" aria-label="The Guestbook app">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ab-testing-with-istio" class="md-nav__link">
    A/B testing with Istio
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canary-deployment" class="md-nav__link">
    Canary deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#route-all-traffic-to-v2" class="md-nav__link">
    Route all traffic to v2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-circuit-breakers-with-destination-rules" class="md-nav__link">
    Implementing Circuit Breakers with Destination Rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    Further reading
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#questions" class="md-nav__link">
    Questions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continue-to-exercise-5-mutual-tls" class="md-nav__link">
    Continue to Exercise 5 - Mutual TLS
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise-7/" class="md-nav__link">
        Lab 5. mutual TLS
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-rules-to-manage-traffic" class="md-nav__link">
    Using rules to manage traffic
  </a>
  
    <nav class="md-nav" aria-label="Using rules to manage traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#virtual-services" class="md-nav__link">
    Virtual Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destination-rules" class="md-nav__link">
    Destination Rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-entries" class="md-nav__link">
    Service Entries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-guestbook-app" class="md-nav__link">
    The Guestbook app
  </a>
  
    <nav class="md-nav" aria-label="The Guestbook app">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ab-testing-with-istio" class="md-nav__link">
    A/B testing with Istio
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canary-deployment" class="md-nav__link">
    Canary deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#route-all-traffic-to-v2" class="md-nav__link">
    Route all traffic to v2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-circuit-breakers-with-destination-rules" class="md-nav__link">
    Implementing Circuit Breakers with Destination Rules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    Further reading
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#questions" class="md-nav__link">
    Questions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continue-to-exercise-5-mutual-tls" class="md-nav__link">
    Continue to Exercise 5 - Mutual TLS
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://jrtorres.github.io/iks-cloudnativeworkshop/edit/master/docs/generatedContent/istio101/exercise-6/README.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="exercise-4-perform-traffic-management">Exercise 4 - Perform traffic management<a class="headerlink" href="#exercise-4-perform-traffic-management" title="Permanent link">&para;</a></h1>
<h2 id="using-rules-to-manage-traffic">Using rules to manage traffic<a class="headerlink" href="#using-rules-to-manage-traffic" title="Permanent link">&para;</a></h2>
<p>Pilot is the core component used for traffic management in Istio. Pilot manages and configures all the Envoy proxy instances deployed in a particular Istio service mesh. It lets you specify what rules you want to use to route traffic between Envoy proxies, which run as sidecars to each service in the mesh.</p>
<p>Pilot translates high-level rules into low-level configurations and distributes this config to Envoy instances. Pilot uses three types of configuration resources to manage traffic within its service mesh:</p>
<ul>
<li>Virtual Services,</li>
<li>Destination Rules, and</li>
<li>Service Entries.</li>
</ul>
<h3 id="virtual-services">Virtual Services<a class="headerlink" href="#virtual-services" title="Permanent link">&para;</a></h3>
<p>A <a href="https://istio.io/latest/docs/reference/config/networking/virtual-service/#VirtualService">VirtualService</a> defines a set of traffic routing rules. If a request matches to a routing rule, then it is sent to a named <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#DestinationRule">destination</a> service (or <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#Subset">subset</a> or version of it) defined in the service registry.</p>
<h3 id="destination-rules">Destination Rules<a class="headerlink" href="#destination-rules" title="Permanent link">&para;</a></h3>
<p>A <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#DestinationRule">DestinationRule</a> is a policy that applies after routing has occurred. These rules specify configuration for load balancing, connection pool size from the sidecar, and outlier detection settings to detect and evict unhealthy hosts from the load balancing pool. Any destination <code>host</code> and <code>subset</code> referenced in a <code>VirtualService</code> rule must be defined in a corresponding <code>DestinationRule</code>.</p>
<h3 id="service-entries">Service Entries<a class="headerlink" href="#service-entries" title="Permanent link">&para;</a></h3>
<p>A <a href="https://istio.io/latest/docs/reference/config/networking/service-entry/#ServiceEntry">ServiceEntry</a> configuration enables services within the mesh to access a service not necessarily managed by Istio. The rule describes the endpoints, ports and protocols of a white-listed set of mesh-external domains and IP blocks that services in the mesh are allowed to access.</p>
<h2 id="the-guestbook-app">The Guestbook app<a class="headerlink" href="#the-guestbook-app" title="Permanent link">&para;</a></h2>
<p>The guestbook deployment has two versions: version 1 and version 2. Each version has three instances based <code>replicas</code> in <a href="https://github.com/linsun/examples/blob/master/guestbook-go/guestbook-deployment.yaml">guestbook-deployment.yaml</a> and <a href="https://github.com/linsun/examples/blob/master/guestbook-go/guestbook-v2-deployment.yaml">guestbook-v2-deployment.yaml</a>.</p>
<p>By default, Istio will route requests equally across version 1 and version 2 using a round robin algorithm. However, new versions can easily introduce bugs to a service mesh, so using A/B Testing and Canary Deployments is good practice.</p>
<h3 id="ab-testing-with-istio">A/B testing with Istio<a class="headerlink" href="#ab-testing-with-istio" title="Permanent link">&para;</a></h3>
<p>A/B testing is a method of performing identical tests against two separate service versions in parallel. To prevent Istio from performing the default routing behavior between the original and modernized guestbook service, define the following rules (found in <a href="https://github.com/IBM/istio101/tree/master/workshop/plans">istio101/workshop/plans</a>).</p>
<p>Let's examine the rule:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.istio.io/v1alpha3</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DestinationRule</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">destination-rule-guestbook</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">guestbook</span>
  <span class="nt">subsets</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
      <span class="nt">labels</span><span class="p">:</span>
        <span class="nt">version</span><span class="p">:</span> <span class="s">&#39;1.0&#39;</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v2</span>
      <span class="nt">labels</span><span class="p">:</span>
        <span class="nt">version</span><span class="p">:</span> <span class="s">&#39;2.0&#39;</span>
</code></pre></div>
<p>Create the destination rule,</p>
<div class="highlight"><pre><span></span><code>kubectl create -f guestbook-destination.yaml
</code></pre></div>
<p>Next, examine the virtual service:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.istio.io/v1alpha3</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VirtualService</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">virtual-service-guestbook</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;*&#39;</span>
  <span class="nt">gateways</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">guestbook-gateway</span>
  <span class="nt">http</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">route</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">destination</span><span class="p">:</span>
            <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">guestbook</span>
            <span class="nt">subset</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
</code></pre></div>
<p>Apply the VirtualService</p>
<div class="highlight"><pre><span></span><code>kubectl replace -f virtualservice-all-v1.yaml
</code></pre></div>
<p>The <code>VirtualService</code> defines a rule that captures all HTTP traffic coming in through the Istio ingress gateway, <code>guestbook-gateway</code>, and routes 100% of the traffic to pods of the guestbook service with label "version: v1". </p>
<p>a corresponding <code>DestinationRule</code> defines <code>subsets</code>, which are referenced as destinations in the <code>VirtualService</code>. Since there are three instances matching the criteria of hostname <code>guestbook</code> with subset <code>version: v1</code>, by default Envoy will send traffic to all three instances in a round robin manner.</p>
<p>Get the Ingress subdomain or NLB host name for your cluster,</p>
<div class="highlight"><pre><span></span><code><span class="nv">NLB_HOSTNAME</span><span class="o">=</span><span class="k">$(</span>ibmcloud ks cluster get --show-resources -c <span class="nv">$MYCLUSTER</span> --json <span class="p">|</span> jq -r <span class="s1">&#39;.ingressHostname&#39;</span><span class="k">)</span>
<span class="nb">echo</span> <span class="nv">$NLB_HOSTNAME</span>
</code></pre></div>
<p>Open the URL in a private window of Firefox or Chrome. You should see version 1 of the Guestbook application load.</p>
<p>To enable the Istio service mesh for A/B testing against version 2, modify the original <code>VirtualService</code> rule.</p>
<p>Examine the new rule:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.istio.io/v1alpha3</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VirtualService</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">virtual-service-guestbook</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;*&#39;</span>
  <span class="nt">gateways</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">guestbook-gateway</span>
  <span class="nt">http</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">headers</span><span class="p">:</span>
            <span class="nt">user-agent</span><span class="p">:</span>
              <span class="nt">regex</span><span class="p">:</span> <span class="s">&#39;.*Firefox.*&#39;</span>
      <span class="nt">route</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">destination</span><span class="p">:</span>
            <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">guestbook</span>
            <span class="nt">subset</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v2</span>
    <span class="p p-Indicator">-</span> <span class="nt">route</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">destination</span><span class="p">:</span>
            <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">guestbook</span>
            <span class="nt">subset</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
</code></pre></div>
<p>Create the rule,</p>
<div class="highlight"><pre><span></span><code>kubectl replace -f virtualservice-test.yaml
</code></pre></div>
<p><img alt="guestbook app in chrome and firefox" src="../README_images/firefoxchrome.png" /></p>
<p>In Istio <code>VirtualService</code> rules, there can be only one rule for each service and therefore when defining multiple <a href="https://istio.io/latest/docs/reference/config/networking/virtual-service/#HTTPRoute">HTTPRoute</a> blocks, the order in which they are defined in the yaml matters. Hence, the original <code>VirtualService</code> rule is modified rather than creating a new rule. With the modified rule, incoming requests originating from <code>Firefox</code> browsers will go to version 2 of Guestbook. All other requests fall-through to the next block, which routes all traffic to version 1 of Guestbook.</p>
<h3 id="canary-deployment">Canary deployment<a class="headerlink" href="#canary-deployment" title="Permanent link">&para;</a></h3>
<p>In <code>Canary Deployments</code>, newer versions of services are incrementally rolled out to users to minimize the risk and impact of any bugs introduced by the newer version. To begin incrementally routing traffic to the newer version of the guestbook service, modify the original <code>VirtualService</code> rule:</p>
<div class="highlight"><pre><span></span><code>kubectl replace -f virtualservice-80-20.yaml
</code></pre></div>
<p>Let's examine the rule:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.istio.io/v1alpha3</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VirtualService</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">virtual-service-guestbook</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;*&#39;</span>
  <span class="nt">gateways</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">guestbook-gateway</span>
  <span class="nt">http</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">route</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">destination</span><span class="p">:</span>
            <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">guestbook</span>
            <span class="nt">subset</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
          <span class="nt">weight</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
        <span class="p p-Indicator">-</span> <span class="nt">destination</span><span class="p">:</span>
            <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">guestbook</span>
            <span class="nt">subset</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v2</span>
          <span class="nt">weight</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">20</span>
</code></pre></div>
<p>In the modified rule, the routed traffic is split between two different subsets of the guestbook service. In this manner, traffic to version 2 of Guestbook is controlled on a percentage basis to limit the impact of any unforeseen bugs. This rule can be modified over time until eventually all traffic is directed to version 2 of the service.</p>
<p>View the Guestbook application using the <code>$NLB_HOSTNAME</code> and enter it as a URL in Firefox or Chrome web browsers. <strong>Ensure that you are using a hard refresh (command + Shift + R on Mac or Ctrl + F5 on windows) to remove any browser caching.</strong> You should notice that the Guestbook should swap between V1 or V2 at about the weight you specified.</p>
<h3 id="route-all-traffic-to-v2">Route all traffic to v2<a class="headerlink" href="#route-all-traffic-to-v2" title="Permanent link">&para;</a></h3>
<p>For the following exercises, we will route all traffic to guestbook v2 with a new VirtualService rule:</p>
<div class="highlight"><pre><span></span><code>cat <span class="s">&lt;&lt;EOF | kubectl replace -f -</span>
<span class="s">apiVersion: networking.istio.io/v1alpha3</span>
<span class="s">kind: VirtualService</span>
<span class="s">metadata:</span>
<span class="s">  name: virtual-service-guestbook</span>
<span class="s">spec:</span>
<span class="s">  hosts:</span>
<span class="s">    - &#39;*&#39;</span>
<span class="s">  gateways:</span>
<span class="s">    - guestbook-gateway</span>
<span class="s">  http:</span>
<span class="s">    - route:</span>
<span class="s">        - destination:</span>
<span class="s">            host: guestbook</span>
<span class="s">            subset: v2</span>
<span class="s">EOF</span>
</code></pre></div>
<h3 id="implementing-circuit-breakers-with-destination-rules">Implementing Circuit Breakers with Destination Rules<a class="headerlink" href="#implementing-circuit-breakers-with-destination-rules" title="Permanent link">&para;</a></h3>
<p>Istio <code>DestinationRules</code> allow users to configure Envoy's implementation of <a href="https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/circuit_breaking.html?highlight=circuit">circuit breakers</a>. Circuit breakers are critical for defining the behavior for service-to-service communication in the service mesh. In the event of a failure for a particular service, circuit breakers allow users to set global defaults for failure recovery on a per service and/or per service version basis. Users can apply a <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#TrafficPolicy">traffic policy</a> at the top level of the <code>DestinationRule</code> to create circuit breaker settings for an entire service, or it can be defined at the subset level to create settings for a particular version of a service.</p>
<p>Depending on whether a service handles <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#ConnectionPoolSettings-HTTPSettings">HTTP</a> requests or <a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/#ConnectionPoolSettings-TCPSettings">TCP</a> connections, <code>DestinationRules</code> expose a number of ways for Envoy to limit traffic to a particular service as well as define failure recovery behavior for services initiating the connection to an unhealthy service.</p>
<h2 id="further-reading">Further reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://istio.io/latest/docs/concepts/traffic-management/">Istio Concept</a></li>
<li><a href="https://istio.io/latest/docs/reference/config/">Istio Rules API</a></li>
<li><a href="https://istio.io/latest/docs/reference/commands/istioctl/#istioctl-proxy-config">Istio Proxy Debug Tool</a></li>
<li><a href="https://blog.openshift.com/istio-traffic-management-diving-deeper/">Traffic Management</a></li>
<li><a href="https://blog.openshift.com/microservices-patterns-envoy-part-i/">Circuit Breaking</a></li>
<li><a href="https://blog.openshift.com/microservices-patterns-envoy-proxy-part-ii-timeouts-retries/">Timeouts and Retries</a></li>
</ul>
<h2 id="questions">Questions<a class="headerlink" href="#questions" title="Permanent link">&para;</a></h2>
<ol>
<li>Where are routing rules defined?  Options: (VirtualService, DestinationRule, ServiceEntry)  Answer: VirtualService</li>
<li>Where are service versions (subsets) defined?  Options: (VirtualService, DestinationRule, ServiceEntry)  Answer: DestinationRule</li>
<li>Which Istio component is responsible for sending traffic management configurations to Istio sidecars?  Options: (Mixer, Citadel, Pilot, Kubernetes)  Answer: Pilot</li>
<li>What is the name of the default proxy that runs in Istio sidecars and routes requests within the service mesh?  Options: (NGINX, Envoy, HAProxy)  Answer: Envoy</li>
</ol>
<h2 id="continue-to-exercise-5-mutual-tls"><a href="../exercise-7/">Continue to Exercise 5 - Mutual TLS</a><a class="headerlink" href="#continue-to-exercise-5-mutual-tls" title="Permanent link">&para;</a></h2>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../exercise-3/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Lab 3. Deploy Guestbook App
            </div>
          </div>
        </a>
      
      
        <a href="../exercise-7/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Lab 5. mutual TLS
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 IBM Developer
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/ibm" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/ibmdeveloper" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/company/ibm/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/user/developerworks" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://dev.to/ibmdeveloper" target="_blank" rel="noopener" title="dev.to" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.indexes"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fb4a9340.min.js", "version": {"method": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>